---
title: "Moisture Uptake Variance Explained by all Parameters"
author: "Michael Burns"
date: "3/12/2020"
output: html_document
---

This R markdown file is to create a linear model of the moisture uptake data and determine the amount of variance explained by cooking parameters, macro trait estimations and spectral data. 

```{r loading_data}
dataset <- read_csv("../Data/Moisture_Uptake_Master_Dataset_Cook_Macro_Spectra.csv")
```


For ease of use, the spectral data will need to be cut off into its own matrix.  Lets try to do this for each section of the data (sepctra, traits, and cooking parameters)
```{r}
spectra_data <- as.matrix(dataset[c(27:167)])
trait_data <- as.matrix(dataset[c(9:25)])
cooking_data <- as.matrix(dataset[c(6:8)])
```

Now lets create a linear model that we can create an anova table from:
```{r}
mup_lm <- lm(dataset$Moisture_Uptake ~ spectra_data + trait_data + cooking_data)
anova(mup_lm)
anova(mup_lm)["spectra_data","Sum Sq"]
broom::tidy(anova(mup_lm))
```

Above are methods I can use to extract the values of interest.  I think the way I am going to use them is with the tidy function.
```{r}
mup_anova_table <- broom::tidy(anova(mup_lm))
mup_anova_table %>%
  mutate(Total_SS = sum(sumsq),
         `R^2` = sumsq/Total_SS,
         `Data Type` = c("Spectra", "Macro Trait", "Cooking", "Residual")) %>% 
  select(c(`Data Type`, `R^2`))
```

